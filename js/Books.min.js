"use strict";var Books=function(){function e(){Tabletop.init({key:p.publicSpreadsheetUrl,callback:u,wanted:["Read Books"],simpleSheet:!1})}function t(e){if(void 0!=e)for(;e.firstChild;)e.removeChild(e.firstChild)}function n(e,t,n){var a=document.createElement(t);a.innerText=n,e.appendChild(a)}function a(e,t){n(e,"h3","Now Reading");var a=document.createElement("ul"),o=document.createElement("li");i(o,t),r(o,t.Title,t.Author),a.appendChild(o),e.appendChild(a)}function i(e,t){var n=document.createElement("img"),a="https://sites.google.com/site/andyparkhill/home/book-images/"+t.ISBN+".jpg";n.setAttribute("src",a),n.setAttribute("alt","Book cover for "+t.Title+" by "+t.Author),n.setAttribute("width","60px"),n.className="left",e.appendChild(n)}function r(e,t,n){var a=document.createElement("p"),i=document.createElement("b");i.innerText=t,a.appendChild(i),a.innerHTML+=" by "+n,e.appendChild(a)}function o(e,t){var n=document.createElement("p");n.innerText="Finished reading on "+t,e.appendChild(n)}function l(e,t){if(null!=t){var n=document.createElement("p");n.innerText=t,e.appendChild(n)}}function d(e,t){var n="https://sites.google.com/site/andyparkhill/home/book-images/",a="";switch(t){case"1":n+="1_stars.png",a+="Rated as 1 out of 5 stars";break;case"2":n+="2_stars.png",a+="Rated as 2 out of 5 stars";break;case"3":n+="3_stars.png",a+="Rated as 3 out of 5 stars";break;case"4":n+="4_stars.png",a+="Rated as 4 out of 5 stars";break;case"5":n+="5_stars.png",a+="Rated as 5 out of 5 stars";break;default:n="",cell.innerText="No rating"}if(n.length>0){var i=document.createElement("img");i.setAttribute("src",n),i.setAttribute("alt",a),i.setAttribute("width","60px"),e.appendChild(i)}}function s(e,t){n(e,"h3","Recently Finished");for(var a=document.createElement("ul"),s=1;s<=p.numberOfRecentlyReadBooks;s++){var c=document.createElement("li");i(c,t[s]);var m=document.createElement("div");m.className="right",r(m,t[s].Title,t[s].Author),o(m,t[s].DateRead),l(m,t[s].MyReview),d(m,t[s].MyRating),c.appendChild(m),a.appendChild(c)}e.appendChild(a)}function c(e,t){for(var n=[],a=e.slice(),i=0;i<t;i++){var r=Math.ceil(10*Math.random())%a.length;n.push(a.splice(r,1)[0])}return n}function m(e,t,a){var s=a.slice(10).filter(function(e){return"5"===e.MyRating&&e.Classification===t});if(s.length>0){n(e,"h3","Recommended "+t);var m=document.createElement("ul"),u=p.numberOfRecommendedBooks;u>s.length?u=s.length:s=c(s,u);for(var h=0;h<u;h++){var f=document.createElement("li");i(f,s[h],h);var v=document.createElement("div");v.className="right",r(v,s[h].Title,s[h].Author),o(v,s[h].DateRead),l(v,s[h].MyReview),d(v,s[h].MyRating),f.appendChild(v),m.appendChild(f)}e.appendChild(m)}}function u(e,n){var i=document.getElementById("content");t(i),i.innerHTML="";var r=e["Read Books"].elements;if(r.length>0)a(i,r[0]),s(i,r),m(i,"Fiction",r),m(i,"Non-Fiction",r);else{var o=document.createElement("a");o.href="http://www.andyparkhill.co.uk/p/contact-me.html",o.target="_blank",o.innerHTML="Contact form";var l=document.createElement("p");l.innerHTML="Apologies, I'm unable to retrieve the books data. If the error continues, please use the ",l.appendChild(o),l.innerHTML+=" to let me know. Thanks!",i.appendChild(l)}}var p={publicSpreadsheetUrl:"https://docs.google.com/spreadsheets/d/1ZTvkFasPlbF49jGnWqISvI_akMyL1tEGWPPTEmCc56E/pubhtml",numberOfRecentlyReadBooks:5,numberOfRecommendedBooks:5};return{init:e}}();window.addEventListener("DOMContentLoaded",Books.init);