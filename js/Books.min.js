"use strict";var Books=function(){function e(){Tabletop.init({key:p.publicSpreadsheetUrl,callback:h,wanted:["Read Books"],simpleSheet:!1})}function t(e){if(void 0!=e)for(;e.firstChild;)e.removeChild(e.firstChild)}function n(e,t,n){var a=document.createElement(t);a.innerText=n,e.appendChild(a)}function a(e,t){n(e,"h3","Now Reading");var a=document.createElement("ul"),o=document.createElement("li");i(o,t),r(o,t.Title,t.Author),a.appendChild(o),e.appendChild(a)}function i(e,t){var n=document.createElement("img"),a="https://sites.google.com/site/andyparkhill/home/book-images/"+t.ISBN+".jpg";n.setAttribute("src",a),n.setAttribute("alt","Book cover for "+t.Title+" by "+t.Author),n.setAttribute("width","60px"),n.className="left",e.appendChild(n)}function r(e,t,n){var a=document.createElement("p"),i=document.createElement("b");i.innerText=t,a.appendChild(i),a.innerHTML+=" by "+n,e.appendChild(a)}function o(e,t){var n=document.createElement("p");n.innerText="Finished reading on "+t,e.appendChild(n)}function l(e,t){if(null!=t){var n=document.createElement("p");n.innerText=t,e.appendChild(n)}}function d(e,t){var n="https://sites.google.com/site/andyparkhill/home/book-images/",a="";switch(t){case"1":n+="1_stars.png",a+="Rated as 1 out of 5 stars";break;case"2":n+="2_stars.png",a+="Rated as 2 out of 5 stars";break;case"3":n+="3_stars.png",a+="Rated as 3 out of 5 stars";break;case"4":n+="4_stars.png",a+="Rated as 4 out of 5 stars";break;case"5":n+="5_stars.png",a+="Rated as 5 out of 5 stars";break;default:n="",cell.innerText="No rating"}if(n.length>0){var i=document.createElement("img");i.setAttribute("src",n),i.setAttribute("alt",a),i.setAttribute("width","60px"),e.appendChild(i)}}function c(e,t){n(e,"h3","Recently Finished");for(var a=document.createElement("ul"),c=1;c<=p.numberOfRecentlyReadBooks;c++){var s=document.createElement("li");i(s,t[c]);var m=document.createElement("div");m.className="right",r(m,t[c].Title,t[c].Author),o(m,t[c].DateRead),l(m,t[c].MyReview),d(m,t[c].MyRating),s.appendChild(m),a.appendChild(s)}e.appendChild(a)}function s(e,t){for(var n=[],a=e.slice(),i=0;i<t;i++){var r=Math.ceil(10*Math.random())%a.length;n.push(a.splice(r,1)[0])}return n}function m(e,t,a){var c=a.slice(p.numberOfRecentlyReadBooks+1).filter(function(e){return("5"===e.MyRating||"4"===e.MyRating)&&e.Classification===t});if(c.length>0){n(e,"h3","Recommended "+t);var m=document.createElement("ul"),u=p.numberOfRecommendedBooks;u>c.length?u=c.length:c=s(c,u);for(var h=0;h<u;h++){var f=document.createElement("li");i(f,c[h],h);var v=document.createElement("div");v.className="right",r(v,c[h].Title,c[h].Author),o(v,c[h].DateRead),l(v,c[h].MyReview),d(v,c[h].MyRating),f.appendChild(v),m.appendChild(f)}e.appendChild(m)}}function u(e,t){var a=t.slice(p.numberOfRecentlyReadBooks+1).filter(function(e){return"1"===e.MyRating});if(a.length>0){n(e,"h3","Books to Avoid");var c=document.createElement("ul"),m=p.numberOfRecommendedBooks;m>a.length?m=a.length:a=s(a,m);for(var u=0;u<m;u++){var h=document.createElement("li");i(h,a[u],u);var f=document.createElement("div");f.className="right",r(f,a[u].Title,a[u].Author),o(f,a[u].DateRead),l(f,a[u].MyReview),d(f,a[u].MyRating),h.appendChild(f),c.appendChild(h)}e.appendChild(c)}}function h(e,n){var i=document.getElementById("content");t(i),i.innerHTML="";var r=e["Read Books"].elements;if(r.length>0)a(i,r[0]),c(i,r),m(i,"Fiction",r),m(i,"Non-Fiction",r),u(i,r);else{var o=document.createElement("a");o.href="http://www.andyparkhill.co.uk/p/contact-me.html",o.target="_blank",o.innerHTML="Contact form";var l=document.createElement("p");l.innerHTML="Apologies, I'm unable to retrieve the books data. If the error continues, please use the ",l.appendChild(o),l.innerHTML+=" to let me know. Thanks!",i.appendChild(l)}}var p={publicSpreadsheetUrl:"https://docs.google.com/spreadsheets/d/1ZTvkFasPlbF49jGnWqISvI_akMyL1tEGWPPTEmCc56E/pubhtml",numberOfRecentlyReadBooks:5,numberOfRecommendedBooks:5};return{init:e}}();window.addEventListener("DOMContentLoaded",Books.init);