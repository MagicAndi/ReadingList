"use strict";var Books=function(){function e(){Tabletop.init({key:f.publicSpreadsheetUrl,callback:h,wanted:["Read Books"],simpleSheet:!1})}function t(e){if(void 0!=e)for(;e.firstChild;)e.removeChild(e.firstChild)}function n(e,t,n){var a=document.createElement(t);a.innerText=n,e.appendChild(a)}function a(e,t){n(e,"h3","Now Reading");var a=document.createElement("ul"),l=document.createElement("li");i(l,t),o(l,t.Title),r(l,t.Author),a.appendChild(l),e.appendChild(a)}function i(e,t){var n=document.createElement("img"),a="https://sites.google.com/site/andyparkhill/home/book-images/"+t.ISBN+".jpg";n.setAttribute("src",a),n.setAttribute("alt","Book cover for "+t.Title+" by "+t.Author),n.setAttribute("width","50px"),n.className="left",e.appendChild(n)}function o(e,t){var n=document.createElement("p");n.innerText=t,n.style.fontSize="12pt",n.style.fontWeight="Bold",e.appendChild(n)}function r(e,t){var n=document.createElement("p");n.innerText="by "+t,e.appendChild(n)}function l(e,t,n){var a=document.createElement("p");a.innerText="Finished reading on "+t,n&&(a.innerText+=". "+n),e.appendChild(a)}function d(e,t){var n="https://sites.google.com/site/andyparkhill/home/book-images/",a="";switch(t){case"1":n+="1_stars.png",a+="Rated as 1 out of 5 stars";break;case"2":n+="2_stars.png",a+="Rated as 2 out of 5 stars";break;case"3":n+="3_stars.png",a+="Rated as 3 out of 5 stars";break;case"4":n+="4_stars.png",a+="Rated as 4 out of 5 stars";break;case"5":n+="5_stars.png",a+="Rated as 5 out of 5 stars";break;default:n="",cell.innerText="No rating",console.log("Rating not set!")}if(n.length>0){var i=document.createElement("img");i.setAttribute("src",n),i.setAttribute("alt",a),i.setAttribute("width","60px"),e.appendChild(i)}}function s(e,t){n(e,"h3","Recently Finished");for(var a=document.createElement("ul"),s=1;s<=f.numberOfRecentlyReadBooks;s++){var c=document.createElement("li");i(c,t[s]);var m=document.createElement("div");m.className="right",o(m,t[s].Title),r(m,t[s].Author),l(m,t[s].DateRead,t[s].MyReview),d(m,t[s].MyRating),c.appendChild(m),a.appendChild(c)}e.appendChild(a)}function c(e,t){for(var n=[],a=e.slice(),i=0;i<t;i++){var o=Math.ceil(10*Math.random())%a.length;n.push(a.splice(o,1)[0])}return n}function m(e,t,a){var s=a.slice(10).filter(function(e){return"5"===e.MyRating&&e.Classification===t});if(s.length>0){n(e,"h4",t);var m=document.createElement("ul"),u=f.numberOfRecommendedBooks;u>s.length?u=s.length:s=c(s,u);for(var p=0;p<u;p++){var h=document.createElement("li");i(h,s[p],p);var g=document.createElement("div");g.className="right",o(g,s[p].Title),r(g,s[p].Author),l(g,s[p].DateRead),d(g,s[p].MyRating),h.appendChild(g),m.appendChild(h)}e.appendChild(m)}}function u(e,t){var a=document.createElement("div");a.className="rightColumn",n(a,"h3","Highly Recommended",t),m(a,"Fiction",t),m(a,"Non-Fiction",t),e.appendChild(a)}function p(e,t){var n=document.createElement("div");n.className="leftColumn",a(n,t[0]),s(n,t),e.appendChild(n)}function h(e,n){var a=document.getElementById("content");t(a),a.innerHTML="";var i=e["Read Books"].elements;if(i.length>0)p(a,i),u(a,i);else{var o=document.createElement("a");o.href="http://www.andyparkhill.co.uk/p/contact-me.html",o.target="_blank",o.innerHTML="Contact form";var r=document.createElement("p");r.innerHTML="Apologies, I'm unable to retrieve the books data. If the error continues, please use the ",r.appendChild(o),r.innerHTML+=" to let me know. Thanks!",a.appendChild(r)}}var f={publicSpreadsheetUrl:"https://docs.google.com/spreadsheets/d/1ZTvkFasPlbF49jGnWqISvI_akMyL1tEGWPPTEmCc56E/pubhtml",numberOfRecentlyReadBooks:10,numberOfRecommendedBooks:6};return{init:e}}();window.addEventListener("DOMContentLoaded",Books.init);